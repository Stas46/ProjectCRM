# üóÑÔ∏è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ—á–∏—Å—Ç–∫–µ –∏ —Å–æ–∑–¥–∞–Ω–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –°–¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø!

–ü–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —Å–¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø –¥–∞–Ω–Ω—ã—Ö –≤ Supabase Dashboard.

---

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ Supabase SQL Editor

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [Supabase Dashboard](https://app.supabase.com)
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –û—Ç–∫—Ä–æ–π—Ç–µ **SQL Editor**

---

### –®–∞–≥ 2: –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ —Ç–∞–±–ª–∏—Ü—ã

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ **`RESET-SCHEMA.sql`**
2. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor
3. –ù–∞–∂–º–∏—Ç–µ **RUN**
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (–¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è "Success")

**–ß—Ç–æ —É–¥–∞–ª–∏—Ç—Å—è:**
- ‚ùå –í—Å–µ —Å—Ç–∞—Ä—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
  - –û—Å–Ω–æ–≤–Ω—ã–µ: invoices, suppliers, projects, clients, tasks, employees
  - –ë—Ä–∏–≥–∞–¥—ã: crews, crew_members, shifts, shift_assignees
  - –°–æ–æ–±—â–µ–Ω–∏—è: project_messages, message_attachments, task_comments, task_attachments
  - –ö–∞—Ç–µ–≥–æ—Ä–∏–∏: expense_categories, custom_expense_categories
  - –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞: contractors, invoice_items, unified_items, price_history, item_name_variants
- ‚ùå –í—Å–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (views)
- ‚ùå –í—Å–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏

---

### –®–∞–≥ 3: –°–æ–∑–¥–∞–π—Ç–µ —á–∏—Å—Ç—É—é —Å—Ö–µ–º—É

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ **`CREATE-CLEAN-SCHEMA.sql`**
2. –í—Å—Ç–∞–≤—å—Ç–µ –≤ SQL Editor (–æ—á–∏—Å—Ç–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∑–∞–ø—Ä–æ—Å)
3. –ù–∞–∂–º–∏—Ç–µ **RUN**
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

**–ß—Ç–æ —Å–æ–∑–¥–∞—Å—Ç—Å—è:**
- ‚úÖ `suppliers` - –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏
- ‚úÖ `invoices` - –°—á–µ—Ç–∞ (—Å –ø–æ–ª–µ–º `project_id` –¥–ª—è –±—É–¥—É—â–µ–π –ø—Ä–∏–≤—è–∑–∫–∏)
- ‚úÖ `invoices_with_suppliers` - View —Å–æ —Å—á–µ—Ç–∞–º–∏ –∏ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º–∏
- ‚úÖ `supplier_totals` - View —Å —Å—É–º–º–∞–º–∏ –ø–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- ‚úÖ –¢—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `updated_at`

---

### –®–∞–≥ 4: –û—á–∏—Å—Ç–∏—Ç–µ Storage

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Storage** –≤ Supabase Dashboard
2. –ï—Å–ª–∏ –µ—Å—Ç—å bucket `invoices` - **—É–¥–∞–ª–∏—Ç–µ –µ–≥–æ**
3. –°–æ–∑–¥–∞–π—Ç–µ **–Ω–æ–≤—ã–π bucket** —Å –∏–º–µ–Ω–µ–º `invoices`
4. –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
   - ‚úÖ **Public bucket**: ON
   - ‚úÖ **File size limit**: 50 MB
   - ‚úÖ **Allowed MIME types**: `application/pdf`, `image/*`

---

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å –≤ SQL Editor:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
  AND table_type = 'BASE TABLE'
ORDER BY table_name;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π
SELECT table_name 
FROM information_schema.views 
WHERE table_schema = 'public'
ORDER BY table_name;
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

–¢–∞–±–ª–∏—Ü—ã:
- suppliers
- invoices

–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è:
- invoices_with_suppliers
- supplier_totals

---

## ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞!

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∫–æ–¥–∞:

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–∏–ø—ã –∏–∑ `invoice-system-clean/types/` –≤ `src/types/`
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ API –∏–∑ `invoice-system-clean/api/` –≤ `src/app/api/smart-invoice/`
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.env.local`
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run dev`
5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É —Å—á–µ—Ç–∞

–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: `invoice-system-clean/QUICKSTART.md`

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å—á–µ—Ç–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```sql
-- –í—Å–µ —Å—á–µ—Ç–∞
SELECT * FROM invoices_with_suppliers;

-- –í—Å–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏ —Å —Å—É–º–º–∞–º–∏
SELECT * FROM supplier_totals;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ Storage
-- (–æ—Ç–∫—Ä–æ–π—Ç–µ Storage ‚Üí invoices –≤ Dashboard)
```

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–æ–≤–æ–π –ë–î

```
suppliers (–ø–æ—Å—Ç–∞–≤—â–∏–∫–∏)
‚îú‚îÄ‚îÄ id
‚îú‚îÄ‚îÄ name *
‚îú‚îÄ‚îÄ inn
‚îú‚îÄ‚îÄ phone
‚îú‚îÄ‚îÄ email
‚îú‚îÄ‚îÄ legal_address
‚îú‚îÄ‚îÄ category
‚îú‚îÄ‚îÄ created_at
‚îî‚îÄ‚îÄ updated_at

invoices (—Å—á–µ—Ç–∞)
‚îú‚îÄ‚îÄ id
‚îú‚îÄ‚îÄ supplier_id ‚Üí suppliers.id
‚îú‚îÄ‚îÄ project_id (–¥–ª—è –±—É–¥—É—â–µ–π –ø—Ä–∏–≤—è–∑–∫–∏)
‚îú‚îÄ‚îÄ invoice_number *
‚îú‚îÄ‚îÄ invoice_date *
‚îú‚îÄ‚îÄ total_amount *
‚îú‚îÄ‚îÄ vat_amount
‚îú‚îÄ‚îÄ file_url *
‚îú‚îÄ‚îÄ created_at
‚îî‚îÄ‚îÄ updated_at
```

---

## üÜò –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫?

### –û—à–∏–±–∫–∞: "relation already exists"
‚Üí –í—ã–ø–æ–ª–Ω–∏—Ç–µ `RESET-SCHEMA.sql` –µ—â–µ —Ä–∞–∑, –∑–∞—Ç–µ–º `CREATE-CLEAN-SCHEMA.sql`

### –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ view
‚Üí –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã `suppliers` –∏ `invoices` —Å–æ–∑–¥–∞–Ω—ã

### Storage bucket –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è
‚Üí –°–æ–∑–¥–∞–π—Ç–µ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ Dashboard ‚Üí Storage ‚Üí New bucket

---

## üìù –§–∞–π–ª—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ

–ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –ë–î —ç—Ç–∏ —Ñ–∞–π–ª—ã –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å:

```
database/
database-schema/
supabase/
*.sql (–≤—Å–µ —Å—Ç–∞—Ä—ã–µ SQL —Ñ–∞–π–ª—ã, –∫—Ä–æ–º–µ CREATE-CLEAN-SCHEMA.sql –∏ RESET-SCHEMA.sql)
```

–û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ:
- ‚úÖ `CREATE-CLEAN-SCHEMA.sql`
- ‚úÖ `RESET-SCHEMA.sql`
- ‚úÖ `invoice-system-clean/` (–≤—Å—è –ø–∞–ø–∫–∞)
