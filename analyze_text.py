#!/usr/bin/env python3
"""
Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Ð´ÐµÑ‚Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ñ‚ÐµÐºÑÑ‚Ð° Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°
"""

import sys
import os

def analyze_text_file(file_path):
    """ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ñ„Ð°Ð¹Ð» Ð½Ð° Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚ Ð¿Ð¾Ð»Ð½Ð¾Ñ‚Ñ‹"""
    print(f"ðŸ” ÐÐ½Ð°Ð»Ð¸Ð· Ñ„Ð°Ð¹Ð»Ð°: {file_path}")
    
    if not os.path.exists(file_path):
        print(f"âŒ Ð¤Ð°Ð¹Ð» Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½: {file_path}")
        return
    
    try:
        with open(file_path, 'r', encoding='utf-8') as f:
            content = f.read()
        
        print(f"ðŸ“Š ÐžÐ±Ñ‰Ð¸Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€ Ñ‚ÐµÐºÑÑ‚Ð°: {len(content)} ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²")
        print(f"ðŸ“Š ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÑ‚Ñ€Ð¾Ðº: {len(content.splitlines())}")
        print(f"ðŸ“Š ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐ»Ð¾Ð²: {len(content.split())}")
        
        # Ð˜Ñ‰ÐµÐ¼ ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ñ‡Ð°ÑÑ‚Ð¸ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°
        print("\nðŸ” ÐŸÐ¾Ð¸ÑÐº ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ñ… Ñ‡Ð°ÑÑ‚ÐµÐ¹:")
        
        keywords = [
            "ARLIFT",
            "Ð¡Ð§ÐÐ¢-Ð”ÐžÐ“ÐžÐ’ÐžÐ ", 
            "22980",
            "Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð ÐµÐ½Ñ‚Ð°Ð» Ð˜Ð½Ð¶Ð¸Ð½Ð¸Ñ€Ð¸Ð½Ð³",
            "Ð¢ÐµÐ»ÐµÑÐºÐ¾Ð¿Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿Ð¾Ð´ÑŠÑ‘Ð¼Ð½Ð¸Ðº",
            "39 480,00",
            "ÐÐ”Ð¡ (20%)",
            "6 580,00",
            "Ð ÑƒÐºÐ¾Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒ",
            "ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð¾Ð²"
        ]
        
        for keyword in keywords:
            if keyword in content:
                position = content.find(keyword)
                print(f"âœ… '{keyword}' Ð½Ð°Ð¹Ð´ÐµÐ½ Ð½Ð° Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ {position}")
            else:
                print(f"âŒ '{keyword}' ÐÐ• ÐÐÐ™Ð”Ð•Ð")
        
        # ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð½Ð°Ñ‡Ð°Ð»Ð¾ Ð¸ ÐºÐ¾Ð½ÐµÑ† Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°
        print(f"\nðŸ“ ÐŸÐµÑ€Ð²Ñ‹Ðµ 200 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²:")
        print(repr(content[:200]))
        
        print(f"\nðŸ“ ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 200 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²:")
        print(repr(content[-200:]))
        
        # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ð¾Ð±Ñ€ÐµÐ·Ð°Ð½ Ð»Ð¸ Ñ‚ÐµÐºÑÑ‚
        if content.endswith("Ð¡Ð°Ð¼Ð¾..."):
            print("âš ï¸  Ð’ÐÐ˜ÐœÐÐÐ˜Ð•: Ð¢ÐµÐºÑÑ‚ Ð¾Ð±Ñ€ÐµÐ·Ð°Ð½! Ð—Ð°ÐºÐ°Ð½Ñ‡Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð½Ð° 'Ð¡Ð°Ð¼Ð¾...'")
        elif "ÐÐ»ÐµÐºÑÐ°Ð½Ð´Ñ€Ð¾Ð²" in content:
            print("âœ… Ð¢ÐµÐºÑÑ‚ Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ Ð¿Ð¾Ð»Ð½Ñ‹Ð¼ - Ð½Ð°Ð¹Ð´ÐµÐ½Ð° Ð¿Ð¾Ð´Ð¿Ð¸ÑÑŒ Ð² ÐºÐ¾Ð½Ñ†Ðµ")
        else:
            print("âš ï¸  Ð¢ÐµÐºÑÑ‚ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð½ÐµÐ¿Ð¾Ð»Ð½Ñ‹Ð¼")
            
    except Exception as e:
        print(f"âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ñ‡Ñ‚ÐµÐ½Ð¸Ð¸ Ñ„Ð°Ð¹Ð»Ð°: {e}")

if __name__ == "__main__":
    if len(sys.argv) > 1:
        file_path = sys.argv[1]
    else:
        file_path = "temp/full_invoice_test.txt"
    
    analyze_text_file(file_path)