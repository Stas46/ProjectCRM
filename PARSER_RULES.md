# ПРАВИЛА ПАРСЕРА СЧЕТОВ - ТЕКУЩАЯ КОНФИГУРАЦИЯ

## 1. ИЗВЛЕЧЕНИЕ НОМЕРА СЧЕТА (по приоритету)

### Высокий приоритет - Буквенно-цифровые номера:
- № [БУКВА]+-[ЦИФРЫ]  (УТ-784, А-123, Б-456)
- СЧЕТ/СЧЁТ № [БУКВА]+-[ЦИФРЫ]
- С[ЧТ] № [БУКВА]+-[ЦИФРЫ]  (для OCR ошибок)

### Средний приоритет - Специальные форматы:
- СЧЕТ-ДОГОВОР № [ЦИФРЫ]  (22980)
- № [0000ЦИФРЫ] от  (00000007898)
- СЧЕТ/СЧЁТ № [0000ЦИФРЫ]

### Низкий приоритет - Обычные номера:
- СЧЕТ/СЧЁТ № [ЦИФРЫ]
- № [ЦИФРЫ] от [ДАТА]
- Invoice № [ЦИФРЫ]

### Очень низкий приоритет:
- С[ЧТ] [ЦИФРЫ] от  (для OCR "СТ 00000007883 от")
- № [2-10 ЦИФР] от

### Исключения:
- Исключаются ИНН (10 или 12 цифр)

## 2. ИЗВЛЕЧЕНИЕ ДАТЫ СЧЕТА

### Русские даты:
- [ДЕНЬ] [МЕСЯЦ_РУССКИЙ] [ГОД] г.
- от [ДЕНЬ] [МЕСЯЦ_РУССКИЙ] [ГОД]
- [ДЕНЬ].[МЕСЯЦ].[ГОД]

### Поддерживаемые месяцы:
января, февраля, марта, апреля, мая, июня, июля, августа, сентября, октября, ноября, декабря

## 3. ИЗВЛЕЧЕНИЕ СУММЫ СЧЕТА (по приоритету)

### Высокий приоритет:
1. всего к оплате: [СУММА]
2. Итого/ИТОГО: [СУММА]
3. к доплате: [СУММА]
4. Всего/ВСЕГО: [СУММА]
5. общая стоимость: [СУММА]

### Средний приоритет:
6. [БОЛЬШИЕ_ЦИФРЫ].XX руб  (только суммы >1000)
7. [6+ ЦИФР].XX  (только очень большие числа)

### Условие:
- Минимальная сумма > 100 рублей

## 4. ИЗВЛЕЧЕНИЕ НДС

### Паттерны:
- НДС [СТАВКА]%: [СУММА]
- в том числе НДС: [СУММА]
- том числе НДС ([СТАВКА]%): [СУММА]

## 5. ИЗВЛЕЧЕНИЕ НАЗВАНИЯ ПОСТАВЩИКА (по приоритету)

### Высокий приоритет:
1. Поставщик: [НАЗВАНИЕ]
2. ООО "Группа компаний [ДОПОЛНЕНИЕ]"
3. Получатель: [ТИП_КОМПАНИИ] [НАЗВАНИЕ]

### Средний приоритет:
4. Первая найденная компания (исключая заказчика/покупателя)

### Исключения:
- Заказчик: [НАЗВАНИЕ]
- Покупатель: [НАЗВАНИЕ]

## 6. ИЗВЛЕЧЕНИЕ ИНН ПОСТАВЩИКА (по приоритету)

### Высокий приоритет:
1. Поставщик: ... ИНН [НОМЕР]
2. [ИНН]/[КПП] ООО "Группа компаний"
3. ООО "Группа компаний" ... ИНН [НОМЕР]

### Средний приоритет:
4. Все ИНН исключая заказчика/покупателя
5. ИНН из секции поставщика
6. ИНН из банковских реквизитов получателя

### Исключения:
- ИНН из секций "Заказчик:" и "Покупатель:"

## 7. ИЗВЛЕЧЕНИЕ КПП

### Паттерны:
- КПП: [НОМЕР]
- КПП [НОМЕР]

## 8. АДРЕС ПОСТАВЩИКА

### Паттерны:
- Адрес: [ТЕКСТ]
- [ИНДЕКС], г. [ГОРОД], [УЛИЦА]

---

## НАСТРОЙКИ ОТЛАДКИ:
- debug=True: выводит найденные значения
- debug=False: только результат

## ФОРМАТЫ ВЫВОДА:
- JSON: {"invoice": {...}, "contractor": {...}}
- readable: человекочитаемый формат

Какие правила нужно изменить или добавить?