# Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¿Ð°Ñ€ÑÐµÑ€Ð° ÑÑ‡ÐµÑ‚Ð¾Ð²

Ð­Ñ‚Ð° ÑÐ¸ÑÑ‚ÐµÐ¼Ð° Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°Ñ‚ÑŒ Ñ€Ð°Ð·Ð½Ñ‹Ðµ Ð²Ð¸Ð´Ñ‹ ÑÑ‡ÐµÑ‚Ð¾Ð², Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ð°Ñ€ÑÐµÑ€ Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°Ñ‚ÑŒ ÐµÐ³Ð¾ Ð´Ð»Ñ Ð»ÑƒÑ‡ÑˆÐµÐ³Ð¾ Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð²Ð°Ð½Ð¸Ñ.

## Ð¡Ð¿Ð¾ÑÐ¾Ð±Ñ‹ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹

### 1. Ð’ÐµÐ±-Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ (Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ)

ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ: `http://localhost:3000/parser-test`

**Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸:**
- ðŸ“ Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° PDF Ñ„Ð°Ð¹Ð»Ð¾Ð² ÑÑ‡ÐµÑ‚Ð¾Ð² 
- ðŸ“ Ð’ÑÑ‚Ð°Ð²ÐºÐ° Ñ‚ÐµÐºÑÑ‚Ð° ÑÑ‡ÐµÑ‚Ð¾Ð² Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ
- ðŸ” Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð°Ñ€ÑÐµÑ€Ð° Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
- ðŸ“Š ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² Ð² ÑƒÐ´Ð¾Ð±Ð½Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ
- ðŸ› ÐžÑ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¸ Ð»Ð¾Ð³Ð¸

### 2. ÐšÐ¾Ð¼Ð°Ð½Ð´Ð½Ð°Ñ ÑÑ‚Ñ€Ð¾ÐºÐ°

```bash
cd "C:\Users\Stas\Projects\CRM CLAUDE\glazing-crm\python-scripts"

# Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ð¹ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ ÑÑ‡ÐµÑ‚
python parser_test_suite.py add --name "ÑÑ‡ÐµÑ‚_15922" --text "Ñ‚ÐµÐºÑÑ‚ ÑÑ‡ÐµÑ‚Ð°..."

# ÐŸÑ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ð¹ ÑÑ‡ÐµÑ‚
python parser_test_suite.py test --name "ÑÑ‡ÐµÑ‚_15922"

# ÐŸÑ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð²ÑÐµ ÑÑ‡ÐµÑ‚Ð°
python parser_test_suite.py test-all

# ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ ÑÐ¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… Ñ‚ÐµÑÑ‚Ð¾Ð²
python parser_test_suite.py list
```

### 3. ÐŸÑ€ÑÐ¼Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð°Ñ€ÑÐµÑ€Ð°

```bash
# Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ¾Ð¹
python ultimate_invoice_parser.py --text "Ñ‚ÐµÐºÑÑ‚ ÑÑ‡ÐµÑ‚Ð°" --debug

# JSON Ð²Ñ‹Ð²Ð¾Ð´
python ultimate_invoice_parser.py --text "Ñ‚ÐµÐºÑÑ‚ ÑÑ‡ÐµÑ‚Ð°" --output-format json
```

## ÐšÐ°Ðº Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ðµ Ñ‚Ð¸Ð¿Ñ‹ ÑÑ‡ÐµÑ‚Ð¾Ð²

### ÐœÐµÑ‚Ð¾Ð´ 1: Ð§ÐµÑ€ÐµÐ· Ð²ÐµÐ±-Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ

1. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ `http://localhost:3000/parser-test`
2. Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ PDF Ñ„Ð°Ð¹Ð» Ð¸Ð»Ð¸ Ð²ÑÑ‚Ð°Ð²ÑŒÑ‚Ðµ Ñ‚ÐµÐºÑÑ‚
3. ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ "Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ð°Ñ€ÑÐµÑ€"
4. Ð˜Ð·ÑƒÑ‡Ð¸Ñ‚Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¸ Ð¾Ñ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½ÑƒÑŽ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ

### ÐœÐµÑ‚Ð¾Ð´ 2: Ð§ÐµÑ€ÐµÐ· ÐºÐ¾Ð¼Ð°Ð½Ð´Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð¾ÐºÑƒ

```bash
# Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚Ðµ Ñ‚ÐµÐºÑÑ‚ ÑÑ‡ÐµÑ‚Ð° Ð² Ñ„Ð°Ð¹Ð»
echo "Ñ‚ÐµÐºÑÑ‚ ÑÑ‡ÐµÑ‚Ð°..." > test_invoice.txt

# Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð² ÐºÐ¾Ð»Ð»ÐµÐºÑ†Ð¸ÑŽ Ñ‚ÐµÑÑ‚Ð¾Ð²
python parser_test_suite.py add --name "Ð½Ð¾Ð²Ñ‹Ð¹_Ñ‚Ð¸Ð¿_ÑÑ‡ÐµÑ‚Ð°" --file test_invoice.txt

# ÐŸÑ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ
python parser_test_suite.py test --name "Ð½Ð¾Ð²Ñ‹Ð¹_Ñ‚Ð¸Ð¿_ÑÑ‡ÐµÑ‚Ð°"
```

### ÐœÐµÑ‚Ð¾Ð´ 3: Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÑ‚Ð°Ð»Ð¾Ð½Ð½Ñ‹Ñ… Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð²

```bash
# Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» Ñ Ð¾Ð¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¼ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð¼
cat > expected_result.json << EOF
{
  "invoice": {
    "number": "15922",
    "date": "2025-08-15",
    "total_amount": 90000,
    "vat_amount": 15000,
    "vat_rate": 20,
    "has_vat": true
  },
  "contractor": {
    "name": "ÐšÐžÐœÐŸÐÐÐ˜Ð¯ Ð’Ð˜Ð”ÐÐ›"
  }
}
EOF

# Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ñ‚ÐµÑÑ‚ Ñ ÑÑ‚Ð°Ð»Ð¾Ð½Ð¾Ð¼
python parser_test_suite.py add --name "ÑÑ‡ÐµÑ‚_Ñ_ÑÑ‚Ð°Ð»Ð¾Ð½Ð¾Ð¼" --file invoice.txt --expected expected_result.json
```

## ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¿Ð°Ñ€ÑÐµÑ€Ð°

### Ð£Ð»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ðµ Ñ€ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ñ‹Ñ… Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹

ÐžÑ‚Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» `ultimate_invoice_parser.py`:

```python
# Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð½Ð¾Ð²Ñ‹Ðµ ÑˆÐ°Ð±Ð»Ð¾Ð½Ñ‹ Ð´Ð»Ñ Ð½Ð¾Ð¼ÐµÑ€Ð¾Ð² ÑÑ‡ÐµÑ‚Ð¾Ð²
patterns = [
    r'Ð¡Ñ‡ÐµÑ‚.*?[â„–#No\.]\s*(\d+(?:/\d+)?)',
    r'Invoice\s+#(\d+)',  # Ð”Ð»Ñ Ð°Ð½Ð³Ð»Ð¸Ð¹ÑÐºÐ¸Ñ… ÑÑ‡ÐµÑ‚Ð¾Ð²
    r'Ð¤Ð°ÐºÑ‚ÑƒÑ€Ð°\s+â„–\s*(\d+)',  # Ð”Ð»Ñ ÑƒÐºÑ€Ð°Ð¸Ð½ÑÐºÐ¸Ñ… ÑÑ‡ÐµÑ‚Ð¾Ð²
]

# Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð½Ð¾Ð²Ñ‹Ðµ ÑˆÐ°Ð±Ð»Ð¾Ð½Ñ‹ Ð´Ð»Ñ ÑÑƒÐ¼Ð¼
patterns = [
    r'Ð’ÑÐµÐ³Ð¾ Ðº Ð¾Ð¿Ð»Ð°Ñ‚Ðµ:\s*([0-9\s,]+(?:[.,]\d{2})?)',
    r'Total:\s*([0-9\s,]+(?:[.,]\d{2})?)',  # ÐÐ½Ð³Ð»Ð¸Ð¹ÑÐºÐ¸Ð¹
    r'Razem:\s*([0-9\s,]+(?:[.,]\d{2})?)',  # ÐŸÐ¾Ð»ÑŒÑÐºÐ¸Ð¹
]
```

### Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹

ÐŸÐ¾ÑÐ»Ðµ Ð²Ð½ÐµÑÐµÐ½Ð¸Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹:

```bash
# ÐŸÑ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð²ÑÐµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ ÑÑ‡ÐµÑ‚Ð°
python parser_test_suite.py test-all

# ÐŸÐ¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ñ‚Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚
cat test_invoices/test_report.json
```

## Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ñ„Ð°Ð¹Ð»Ð¾Ð²

```
glazing-crm/
â”œâ”€â”€ src/app/parser-test/page.tsx          # Ð’ÐµÐ±-Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ
â”œâ”€â”€ src/app/api/test-parser/route.ts      # API Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
â”œâ”€â”€ python-scripts/
â”‚   â”œâ”€â”€ ultimate_invoice_parser.py        # ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð¿Ð°Ñ€ÑÐµÑ€
â”‚   â”œâ”€â”€ parser_test_suite.py              # Ð£Ñ‚Ð¸Ð»Ð¸Ñ‚Ð° Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
â”‚   â””â”€â”€ test_invoices/                    # ÐšÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ñ Ñ‚ÐµÑÑ‚Ð¾Ð²
â”‚       â”œâ”€â”€ ÑÑ‡ÐµÑ‚_15920.json
â”‚       â”œâ”€â”€ ÑÑ‡ÐµÑ‚_15922.json
â”‚       â””â”€â”€ test_report.json
â””â”€â”€ README_PARSER_TESTING.md              # Ð­Ñ‚Ð° Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ
```

## Ð¢Ð¸Ð¿Ð¸Ñ‡Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ð¸ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: ÐŸÐ°Ñ€ÑÐµÑ€ Ð½Ðµ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ Ð½Ð¾Ð¼ÐµÑ€ ÑÑ‡ÐµÑ‚Ð°

**Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ°:**
```bash
python ultimate_invoice_parser.py --text "Ð²Ð°Ñˆ Ñ‚ÐµÐºÑÑ‚" --debug
```

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:** Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð½Ð¾Ð²Ñ‹Ð¹ ÑˆÐ°Ð±Ð»Ð¾Ð½ Ð² `extract_invoice_number()`

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð°Ñ ÑÑƒÐ¼Ð¼Ð°

**Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ°:** ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ñ‡Ð¸ÑÐµÐ» Ð² Ñ‚ÐµÐºÑÑ‚Ðµ
**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:** ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚Ðµ ÑˆÐ°Ð±Ð»Ð¾Ð½Ñ‹ Ð² `extract_total_amount()`

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: ÐÐµ Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°ÐµÑ‚ÑÑ ÐÐ”Ð¡

**Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ°:** ÐÐ°Ð¹Ð´Ð¸Ñ‚Ðµ Ñ‚Ð¾Ñ‡Ð½Ñ‹Ð¹ Ñ‚ÐµÐºÑÑ‚ ÐÐ”Ð¡ Ð² ÑÑ‡ÐµÑ‚Ðµ
**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:** Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ ÑˆÐ°Ð±Ð»Ð¾Ð½ Ð² `extract_vat_info()`

## ÐŸÐ¾Ð»ÐµÐ·Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹

```bash
# Ð‘Ñ‹ÑÑ‚Ñ€Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
echo "Ð¡Ñ‡ÐµÑ‚ â„– 123 Ð¾Ñ‚ 01.01.2025 Ð½Ð° ÑÑƒÐ¼Ð¼Ñƒ 1000,00" | python ultimate_invoice_parser.py --text - --debug

# ÐœÐ°ÑÑÐ¾Ð²Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
find . -name "*.txt" -exec python ultimate_invoice_parser.py --file {} \;

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð±ÑÐºÐ°Ð¿Ð° Ñ‚ÐµÑÑ‚Ð¾Ð²
tar -czf parser_tests_backup.tar.gz test_invoices/
```

## ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ð°

Ð¡Ð»ÐµÐ´Ð¸Ñ‚Ðµ Ð·Ð° Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ°Ð¼Ð¸ Ð² Ð¾Ñ‚Ñ‡ÐµÑ‚Ð°Ñ…:
- **Ð¢Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒ Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð²Ð°Ð½Ð¸Ñ** - Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ Ð¸Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ð¾Ð»ÐµÐ¹
- **ÐŸÐ¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ** - ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ñ‚Ð¸Ð¿Ð¾Ð² ÑÑ‡ÐµÑ‚Ð¾Ð² Ð² Ñ‚ÐµÑÑ‚Ð°Ñ…
- **Ð ÐµÐ³Ñ€ÐµÑÑÐ¸Ð¸** - ÑƒÑ…ÑƒÐ´ÑˆÐµÐ½Ð¸Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² Ð¿Ð¾ÑÐ»Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹